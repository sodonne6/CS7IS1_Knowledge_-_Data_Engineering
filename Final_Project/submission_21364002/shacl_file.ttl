@prefix sh:   <http://www.w3.org/ns/shacl#> .
@prefix xsd:  <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix ex: <http://example.org/flight#> .

# define structure of graph to validate

# Airports 

ex:AirportShape a sh:NodeShape ;
    sh:targetClass ex:Airport ;

    #- should only serve a singular city - and the object servesCity should be pointing to is of class City
    sh:property [
        sh:path ex:servesCity ;
        sh:minCount 1 ; sh:maxCount 1 ;
        sh:class ex:City
    ] ;

    # cant more than 1 IATA
    sh:property [
        sh:path ex:iataCode ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
    ] ;
    #latitude must fall between 90 and -90
    sh:property [
        sh:path ex:latitude ;
        sh:datatype xsd:decimal ;
        sh:minInclusive -90 ; sh:maxInclusive 90 ;
        sh:message "Latitude must be between -90 and 90." ;
    ] ;

    #airport name cant be empty
    sh:property [
        sh:path ex:airportName ;
        sh:datatype xsd:string ;
        sh:minLength 1 ;
        sh:message "Airport name must be a non-empty string" ;
    ] .

ex:CityShape a sh:NodeShape ;
    sh:targetClass ex:City ;

    sh:property [
        sh:path ex:hasLandmark ;
        sh:class ex:Landmark ;
        sh:message "cities can only link to the class Landmark with ex:hasLandmark" ;
    ] ;

    #city can only belong to singular country
    sh:property [
        sh:path ex:inCountry ;
        sh:minCount 1 ; 
        sh:maxCount 1 ;
        sh:class ex:Country ;
    ] .


ex:RouteShape a sh:NodeShape ;
    sh:targetClass ex:Route ;

    #exactly 1 origin per route
    sh:property [
        sh:path ex:origin ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:class ex:Airport ;
    ] ;

    #exactly 1 destination per route
    sh:property [
        sh:path ex:destination ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:class ex:Airport ;
    ] ;

    sh:property [
        sh:path ex:stops ;
        sh:datatype xsd:integer ;
        sh:minInclusive 0 ;
        sh:message "stops cant be negative " ;
    ] .


ex:LandmarkShape a sh:NodeShape ;
    sh:targetClass ex:Landmark ;
    sh:property [
        sh:path ex:hasLandmarkType ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:class ex:LandmarkType ;
        sh:message "A landmark must have exactly one ex:hasLandmarkType." ;
    ] .

ex:CountryShape a sh:NodeShape ;
    sh:targetClass ex:Country ;
    sh:property [
        sh:path ex:inContinent ;
        sh:minCount 1 ; sh:maxCount 1 ;
        sh:class ex:Continent ;
        sh:message "Each country must be in exactly one continent" ;
    ] .
    